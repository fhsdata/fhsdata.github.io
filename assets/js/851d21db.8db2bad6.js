/*! For license information please see 851d21db.8db2bad6.js.LICENSE.txt */
"use strict";(self.webpackChunkreact_native_website=self.webpackChunkreact_native_website||[]).push([[60516],{60179:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var s=n(24246),i=n(71670);const r={title:"Using TypeScript with React Native",author:"Ash Furrow",authorTitle:"Software Engineer at Artsy",authorURL:"https://github.com/ashfurrow",authorImageURL:"https://avatars2.githubusercontent.com/u/498212?s=460&v=4",authorTwitter:"ashfurrow",tags:["engineering"]},o=void 0,a={permalink:"/blog/2018/05/07/using-typescript-with-react-native",source:"@site/blog/2018-05-07-using-typescript-with-react-native.md",title:"Using TypeScript with React Native",description:"JavaScript! We all love it. But some of us also love types. Luckily, options exist to add stronger types to JavaScript. My favourite is TypeScript, but React Native supports Flow out of the box. Which you prefer is a matter of preference, they each have their own approach on how to add the magic of types to JavaScript. Today, we're going to look at how to use TypeScript in React Native apps.",date:"2018-05-07T00:00:00.000Z",formattedDate:"May 7, 2018",tags:[{label:"engineering",permalink:"/blog/tags/engineering"}],readingTime:7.34,hasTruncateMarker:!1,authors:[{name:"Ash Furrow",title:"Software Engineer at Artsy",url:"https://github.com/ashfurrow",imageURL:"https://avatars2.githubusercontent.com/u/498212?s=460&v=4"}],frontMatter:{title:"Using TypeScript with React Native",author:"Ash Furrow",authorTitle:"Software Engineer at Artsy",authorURL:"https://github.com/ashfurrow",authorImageURL:"https://avatars2.githubusercontent.com/u/498212?s=460&v=4",authorTwitter:"ashfurrow",tags:["engineering"]},unlisted:!1,prevItem:{title:"State of React Native 2018",permalink:"/blog/2018/06/14/state-of-react-native-2018"},nextItem:{title:"Built with React Native - The Build.com app",permalink:"/blog/2018/04/09/build-com-app"}},c={authorsImageUrls:[void 0]},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Initializing",id:"initializing",level:2},{value:"Adding TypeScript",id:"adding-typescript",level:2},{value:"Migrating to TypeScript",id:"migrating-to-typescript",level:2},{value:"Adding TypeScript Testing Infrastructure",id:"adding-typescript-testing-infrastructure",level:2},{value:"Installing Dependency Type Declarations",id:"installing-dependency-type-declarations",level:2},{value:"Ignoring More Files",id:"ignoring-more-files",level:2},{value:"Adding a Component",id:"adding-a-component",level:2},{value:"Adding a Component Test",id:"adding-a-component-test",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const t=Object.assign({p:"p",a:"a",strong:"strong",pre:"pre",code:"code",em:"em",h2:"h2",ul:"ul",li:"li"},(0,i.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["JavaScript! We all love it. But some of us also love ",(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Data_type",children:"types"}),". Luckily, options exist to add stronger types to JavaScript. My favourite is ",(0,s.jsx)(t.a,{href:"https://www.typescriptlang.org",children:"TypeScript"}),", but React Native supports ",(0,s.jsx)(t.a,{href:"https://flow.org",children:"Flow"})," out of the box. Which you prefer is a matter of preference, they each have their own approach on how to add the magic of types to JavaScript. Today, we're going to look at how to use TypeScript in React Native apps."]}),"\n",(0,s.jsxs)(t.p,{children:["This post uses Microsoft's ",(0,s.jsx)(t.a,{href:"https://github.com/Microsoft/TypeScript-React-Native-Starter",children:"TypeScript-React-Native-Starter"})," repo as a guide."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Update"}),": Since this blog post was written, things have gotten even easier. You can replace all the set up described in this blog post by running just one command:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"npx react-native init MyAwesomeProject --template react-native-template-typescript\n"})}),"\n",(0,s.jsxs)(t.p,{children:["However, there ",(0,s.jsx)(t.em,{children:"are"})," some limitations to Babel's TypeScript support, which the blog post above goes into in detail. The steps outlined in ",(0,s.jsx)(t.em,{children:"this"})," post still work, and Artsy is still using ",(0,s.jsx)(t.a,{href:"https://github.com/ds300/react-native-typescript-transformer",children:"react-native-typescript-transformer"})," in production, but the fastest way to get up and running with React Native and TypeScript is using the above command. You can always switch later if you have to."]}),"\n",(0,s.jsx)(t.p,{children:"In any case, have fun! The original blog post continues below."}),"\n",(0,s.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(t.p,{children:["Because you might be developing on one of several different platforms, targeting several different types of devices, basic setup can be involved. You should first ensure that you can run a plain React Native app without TypeScript. Follow ",(0,s.jsx)(t.a,{href:"/docs/getting-started",children:"the instructions on the React Native website to get started"}),". When you've managed to deploy to a device or emulator, you'll be ready to start a TypeScript React Native app."]}),"\n",(0,s.jsxs)(t.p,{children:["You will also need ",(0,s.jsx)(t.a,{href:"https://nodejs.org/en/",children:"Node.js"}),", ",(0,s.jsx)(t.a,{href:"https://www.npmjs.com",children:"npm"}),", and ",(0,s.jsx)(t.a,{href:"https://yarnpkg.com/lang/en",children:"Yarn"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"initializing",children:"Initializing"}),"\n",(0,s.jsx)(t.p,{children:"Once you've tried scaffolding out an ordinary React Native project, you'll be ready to start adding TypeScript. Let's go ahead and do that."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"react-native init MyAwesomeProject\ncd MyAwesomeProject\n"})}),"\n",(0,s.jsx)(t.h2,{id:"adding-typescript",children:"Adding TypeScript"}),"\n",(0,s.jsx)(t.p,{children:"The next step is to add TypeScript to your project. The following commands will:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"add TypeScript to your project"}),"\n",(0,s.jsxs)(t.li,{children:["add ",(0,s.jsx)(t.a,{href:"https://github.com/ds300/react-native-typescript-transformer",children:"React Native TypeScript Transformer"})," to your project"]}),"\n",(0,s.jsx)(t.li,{children:"initialize an empty TypeScript config file, which we'll configure next"}),"\n",(0,s.jsx)(t.li,{children:"add an empty React Native TypeScript Transformer config file, which we'll configure next"}),"\n",(0,s.jsxs)(t.li,{children:["adds ",(0,s.jsx)(t.a,{href:"https://github.com/DefinitelyTyped/DefinitelyTyped",children:"typings"})," for React and React Native"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Okay, let's go ahead and run these."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"yarn add --dev typescript\nyarn add --dev react-native-typescript-transformer\nyarn tsc --init --pretty --jsx react\ntouch rn-cli.config.js\nyarn add --dev @types/react @types/react-native\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"tsconfig.json"})," file contains all the settings for the TypeScript compiler. The defaults created by the command above are mostly fine, but open the file and uncomment the following line:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:'{\n  /* Search the config file for the following line and uncomment it. */\n  // "allowSyntheticDefaultImports": true,  /* Allow default imports from modules with no default export. This does not affect code emit, just typechecking. */\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"rn-cli.config.js"})," contains the settings for the React Native TypeScript Transformer. Open it and add the following:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"module.exports = {\n  getTransformModulePath() {\n    return require.resolve('react-native-typescript-transformer');\n  },\n  getSourceExts() {\n    return ['ts', 'tsx'];\n  },\n};\n"})}),"\n",(0,s.jsx)(t.h2,{id:"migrating-to-typescript",children:"Migrating to TypeScript"}),"\n",(0,s.jsxs)(t.p,{children:["Rename the generated ",(0,s.jsx)(t.code,{children:"App.js"})," and ",(0,s.jsx)(t.code,{children:"__tests_/App.js"})," files to ",(0,s.jsx)(t.code,{children:"App.tsx"}),". ",(0,s.jsx)(t.code,{children:"index.js"})," needs to use the ",(0,s.jsx)(t.code,{children:".js"})," extension. All new files should use the ",(0,s.jsx)(t.code,{children:".tsx"})," extension (or ",(0,s.jsx)(t.code,{children:".ts"})," if the file doesn't contain any JSX)."]}),"\n",(0,s.jsxs)(t.p,{children:["If you tried to run the app now, you'd get an error like ",(0,s.jsx)(t.code,{children:"object prototype may only be an object or null"}),". This is caused by a failure to import the default export from React as well as a named export on the same line. Open ",(0,s.jsx)(t.code,{children:"App.tsx"})," and modify the import at the top of the file:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-diff",children:"-import React, { Component } from 'react';\n+import React from 'react'\n+import { Component } from 'react';\n"})}),"\n",(0,s.jsx)(t.p,{children:"Some of this has to do with differences in how Babel and TypeScript interoperate with CommonJS modules. In the future, the two will stabilize on the same behaviour."}),"\n",(0,s.jsx)(t.p,{children:"At this point, you should be able to run the React Native app."}),"\n",(0,s.jsx)(t.h2,{id:"adding-typescript-testing-infrastructure",children:"Adding TypeScript Testing Infrastructure"}),"\n",(0,s.jsxs)(t.p,{children:["React Native ships with ",(0,s.jsx)(t.a,{href:"https://github.com/facebook/jest",children:"Jest"}),", so for testing a React Native app with TypeScript, we'll want to add ",(0,s.jsx)(t.a,{href:"https://www.npmjs.com/package/ts-jest",children:"ts-jest"})," to our ",(0,s.jsx)(t.code,{children:"devDependencies"}),"."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"yarn add --dev ts-jest\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Then, we'll open up our ",(0,s.jsx)(t.code,{children:"package.json"})," and replace the ",(0,s.jsx)(t.code,{children:"jest"})," field with the following:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:'{\n  "jest": {\n    "preset": "react-native",\n    "moduleFileExtensions": [\n      "ts",\n      "tsx",\n      "js"\n    ],\n    "transform": {\n      "^.+\\\\.(js)$": "<rootDir>/node_modules/babel-jest",\n      "\\\\.(ts|tsx)$": "<rootDir>/node_modules/ts-jest/preprocessor.js"\n    },\n    "testRegex": "(/__tests__/.*|\\\\.(test|spec))\\\\.(ts|tsx|js)$",\n    "testPathIgnorePatterns": [\n      "\\\\.snap$",\n      "<rootDir>/node_modules/"\n    ],\n    "cacheDirectory": ".jest/cache"\n  }\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["This will configure Jest to run ",(0,s.jsx)(t.code,{children:".ts"})," and ",(0,s.jsx)(t.code,{children:".tsx"})," files with ",(0,s.jsx)(t.code,{children:"ts-jest"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"installing-dependency-type-declarations",children:"Installing Dependency Type Declarations"}),"\n",(0,s.jsxs)(t.p,{children:["To get the best experience in TypeScript, we want the type-checker to understand the shape and API of our dependencies. Some libraries will publish their packages with ",(0,s.jsx)(t.code,{children:".d.ts"})," files (type declaration/type definition files), which can describe the shape of the underlying JavaScript. For other libraries, we'll need to explicitly install the appropriate package in the ",(0,s.jsx)(t.code,{children:"@types/"})," npm scope."]}),"\n",(0,s.jsx)(t.p,{children:"For example, here we'll need types for Jest, React, and React Native, and React Test Renderer."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"yarn add --dev @types/jest @types/react @types/react-native @types/react-test-renderer\n"})}),"\n",(0,s.jsxs)(t.p,{children:["We saved these declaration file packages to our ",(0,s.jsx)(t.em,{children:"dev"})," dependencies because this is a React Native ",(0,s.jsx)(t.em,{children:"app"})," that only uses these dependencies during development and not during runtime. If we were publishing a library to NPM, we might have to add some of these type dependencies as regular dependencies."]}),"\n",(0,s.jsxs)(t.p,{children:["You can read more ",(0,s.jsxs)(t.a,{href:"https://www.typescriptlang.org/docs/handbook/declaration-files/consumption.html",children:["here about getting ",(0,s.jsx)(t.code,{children:".d.ts"})," files"]}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"ignoring-more-files",children:"Ignoring More Files"}),"\n",(0,s.jsxs)(t.p,{children:["For your source control, you'll want to start ignoring the ",(0,s.jsx)(t.code,{children:".jest"})," folder. If you're using git, we can just add entries to our ",(0,s.jsx)(t.code,{children:".gitignore"})," file."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-config",children:"# Jest\n#\n.jest/\n"})}),"\n",(0,s.jsx)(t.p,{children:"As a checkpoint, consider committing your files into version control."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:'git init\ngit add .gitignore # import to do this first, to ignore our files\ngit add .\ngit commit -am "Initial commit."\n'})}),"\n",(0,s.jsx)(t.h2,{id:"adding-a-component",children:"Adding a Component"}),"\n",(0,s.jsxs)(t.p,{children:["Let's add a component to our app. Let's go ahead and create a ",(0,s.jsx)(t.code,{children:"Hello.tsx"})," component. It's a pedagogical component, not something that you'd actually write in an app, but something nontrivial that shows off how to use TypeScript in React Native."]}),"\n",(0,s.jsxs)(t.p,{children:["Create a ",(0,s.jsx)(t.code,{children:"components"})," directory and add the following example."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// components/Hello.tsx\nimport React from 'react';\nimport {Button, StyleSheet, Text, View} from 'react-native';\n\nexport interface Props {\n  name: string;\n  enthusiasmLevel?: number;\n}\n\ninterface State {\n  enthusiasmLevel: number;\n}\n\nexport class Hello extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n\n    if ((props.enthusiasmLevel || 0) <= 0) {\n      throw new Error(\n        'You could be a little more enthusiastic. :D',\n      );\n    }\n\n    this.state = {\n      enthusiasmLevel: props.enthusiasmLevel || 1,\n    };\n  }\n\n  onIncrement = () =>\n    this.setState({\n      enthusiasmLevel: this.state.enthusiasmLevel + 1,\n    });\n  onDecrement = () =>\n    this.setState({\n      enthusiasmLevel: this.state.enthusiasmLevel - 1,\n    });\n  getExclamationMarks = (numChars: number) =>\n    Array(numChars + 1).join('!');\n\n  render() {\n    return (\n      <View style={styles.root}>\n        <Text style={styles.greeting}>\n          Hello{' '}\n          {this.props.name +\n            this.getExclamationMarks(this.state.enthusiasmLevel)}\n        </Text>\n\n        <View style={styles.buttons}>\n          <View style={styles.button}>\n            <Button\n              title=\"-\"\n              onPress={this.onDecrement}\n              accessibilityLabel=\"decrement\"\n              color=\"red\"\n            />\n          </View>\n\n          <View style={styles.button}>\n            <Button\n              title=\"+\"\n              onPress={this.onIncrement}\n              accessibilityLabel=\"increment\"\n              color=\"blue\"\n            />\n          </View>\n        </View>\n      </View>\n    );\n  }\n}\n\n// styles\nconst styles = StyleSheet.create({\n  root: {\n    alignItems: 'center',\n    alignSelf: 'center',\n  },\n  buttons: {\n    flexDirection: 'row',\n    minHeight: 70,\n    alignItems: 'stretch',\n    alignSelf: 'center',\n    borderWidth: 5,\n  },\n  button: {\n    flex: 1,\n    paddingVertical: 0,\n  },\n  greeting: {\n    color: '#999',\n    fontWeight: 'bold',\n  },\n});\n"})}),"\n",(0,s.jsx)(t.p,{children:"Whoa! That's a lot, but let's break it down:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Instead of rendering HTML elements like ",(0,s.jsx)(t.code,{children:"div"}),", ",(0,s.jsx)(t.code,{children:"span"}),", ",(0,s.jsx)(t.code,{children:"h1"}),", etc., we're rendering components like ",(0,s.jsx)(t.code,{children:"View"})," and ",(0,s.jsx)(t.code,{children:"Button"}),". These are native components that work across different platforms."]}),"\n",(0,s.jsxs)(t.li,{children:["Styling is specified using the ",(0,s.jsx)(t.code,{children:"StyleSheet.create"})," function that React Native gives us. React's stylesheets allow us to control our layout using Flexbox, and style using other constructs similar to those in CSS."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"adding-a-component-test",children:"Adding a Component Test"}),"\n",(0,s.jsx)(t.p,{children:"Now that we've got a component, let's try testing it."}),"\n",(0,s.jsx)(t.p,{children:"We already have Jest installed as a test runner. We're going to write snapshot tests for our components, let's add the required add-on for snapshot tests:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"yarn add --dev react-addons-test-utils\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Now let's create a ",(0,s.jsx)(t.code,{children:"__tests__"})," folder in the ",(0,s.jsx)(t.code,{children:"components"})," directory and add a test for ",(0,s.jsx)(t.code,{children:"Hello.tsx"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// components/__tests__/Hello.tsx\nimport React from 'react';\nimport renderer from 'react-test-renderer';\n\nimport {Hello} from '../Hello';\n\nit('renders correctly with defaults', () => {\n  const button = renderer\n    .create(<Hello name=\"World\" enthusiasmLevel={1} />)\n    .toJSON();\n  expect(button).toMatchSnapshot();\n});\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The first time the test is run, it will create a snapshot of the rendered component and store it in the ",(0,s.jsx)(t.code,{children:"components/__tests__/__snapshots__/Hello.tsx.snap"})," file. When you modify your component, you'll need to update the snapshots and review the update for inadvertent changes. You can read more about testing React Native components ",(0,s.jsx)(t.a,{href:"https://facebook.github.io/jest/docs/en/tutorial-react-native.html",children:"here"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(t.p,{children:["Check out the official ",(0,s.jsx)(t.a,{href:"https://reactjs.org/tutorial/tutorial.html",children:"React tutorial"})," and state-management library ",(0,s.jsx)(t.a,{href:"https://redux.js.org",children:"Redux"}),". These resources can be helpful when writing React Native apps. Additionally, you may want to look at ",(0,s.jsx)(t.a,{href:"https://microsoft.github.io/reactxp/",children:"ReactXP"}),", a component library written entirely in TypeScript that supports both React on the web as well as React Native."]}),"\n",(0,s.jsx)(t.p,{children:"Have fun in a more type-safe React Native development environment!"})]})}const h=function(e={}){const{wrapper:t}=Object.assign({},(0,i.ah)(),e.components);return t?(0,s.jsx)(t,Object.assign({},e,{children:(0,s.jsx)(d,e)})):d(e)}},71426:(e,t,n)=>{var s=n(27378),i=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var s,r={},l=null,d=null;for(s in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,s)&&!c.hasOwnProperty(s)&&(r[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===r[s]&&(r[s]=t[s]);return{$$typeof:i,type:e,key:l,ref:d,props:r,_owner:a.current}}t.Fragment=r,t.jsx=l,t.jsxs=l},24246:(e,t,n)=>{e.exports=n(71426)},71670:(e,t,n)=>{n.d(t,{Zo:()=>a,ah:()=>r});var s=n(27378);const i=s.createContext({});function r(e){const t=s.useContext(i);return s.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const o={};function a({components:e,children:t,disableParentContext:n}){let a;return a=n?"function"==typeof e?e({}):e||o:r(e),s.createElement(i.Provider,{value:a},t)}}}]);