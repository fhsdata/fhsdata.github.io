/*! For license information please see e9342a2c.81f228c8.js.LICENSE.txt */
"use strict";(self.webpackChunkreact_native_website=self.webpackChunkreact_native_website||[]).push([[70091],{98619:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var i=n(24246),a=n(71670);const r={title:"Hermes as the Default",authors:["micleo"],tags:["announcement","release"]},o="Hermes As the Default Blogpost",s={permalink:"/blog/2022/07/08/hermes-as-the-default",source:"@site/blog/2022-07-08-hermes-as-the-default.md",title:"Hermes as the Default",description:"Last October, we announced that we had started work towards making Hermes the default engine for all React Native apps.",date:"2022-07-08T00:00:00.000Z",formattedDate:"July 8, 2022",tags:[{label:"announcement",permalink:"/blog/tags/announcement"},{label:"release",permalink:"/blog/tags/release"}],readingTime:4.455,hasTruncateMarker:!0,authors:[{name:"Michael Leon",title:"Software Engineer at Meta",imageURL:"https://github.com/fbmal7.png",key:"micleo"}],frontMatter:{title:"Hermes as the Default",authors:["micleo"],tags:["announcement","release"]},unlisted:!1,prevItem:{title:"Announcing React Native 0.70",permalink:"/blog/2022/09/05/version-070"},nextItem:{title:"Announcing React Native 0.69",permalink:"/blog/2022/06/21/version-069"}},l={authorsImageUrls:[void 0]},d=[{value:"Benchmarking",id:"benchmarking",level:2},{value:"Android Benchmarking Data",id:"android-benchmarking-data",level:2},{value:"TTI Video",id:"tti-video",level:3},{value:"iOS Benchmarking Data",id:"ios-benchmarking-data",level:2},{value:"TTI Video",id:"tti-video-1",level:3},{value:"Slowed Down TTI Video, to better show the difference in startup time.",id:"slowed-down-tti-video-to-better-show-the-difference-in-startup-time",level:3},{value:"React Native/Hermes Integration",id:"react-nativehermes-integration",level:2},{value:"iOS Intl",id:"ios-intl",level:2},{value:"Ongoing Work",id:"ongoing-work",level:2},{value:"Wrap Up",id:"wrap-up",level:2}];function c(e){const t=Object.assign({p:"p",a:"a",strong:"strong",h2:"h2",ul:"ul",li:"li",h3:"h3",code:"code"},(0,a.ah)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["Last October, we ",(0,i.jsx)(t.a,{href:"/blog/2021/10/26/toward-hermes-being-the-default",children:"announced"})," that we had started work towards ",(0,i.jsx)(t.strong,{children:"making"})," ",(0,i.jsx)(t.strong,{children:"Hermes the default engine for all React Native apps"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"Hermes has provided a lot of value to React Native inside of Meta, and we believe the open-source community will benefit as well. Hermes is designed for resource constrained devices and optimizes for start up, app size, and memory consumption. One key difference between Hermes and other JS engines is its ability to compile JavaScript source code to bytecode ahead of time. This precompiled bytecode is bundled inside the binary, and saves the interpreter from having to perform this expensive step during app startup."}),"\n",(0,i.jsxs)(t.p,{children:["Since the announcement, a lot of work has gone into making Hermes better, and today, we are excited to share that ",(0,i.jsx)(t.strong,{children:"React Native 0.70 will ship with Hermes as the default engine."})," This means that all new projects starting on v0.70 will have Hermes enabled by default. With the rollout coming up in July, we want to work closely with the community and make sure the transition is smooth and brings value to all users. This blogpost will go over what you can expect from the change, performance benchmarks, new features, and more. Note that you don\u2019t need to wait for React Native 0.70 to start using Hermes - you can ",(0,i.jsxs)(t.strong,{children:["follow ",(0,i.jsx)(t.a,{href:"/docs/hermes#enabling-hermes",children:"these instructions"})," to enable Hermes on your existing React Native app"]}),"."]}),"\n",(0,i.jsx)(t.p,{children:"Note that while Hermes will be enabled by default in new React Native projects, support for other engines will continue."}),"\n",(0,i.jsx)(t.h2,{id:"benchmarking",children:"Benchmarking"}),"\n",(0,i.jsxs)(t.p,{children:["We measured three different metrics important to app developers: TTI, binary size, and memory consumption. We used the React Native app ",(0,i.jsx)(t.a,{href:"https://github.com/mattermost/mattermost-mobile",children:"Mattermost"})," for testing. We ran these experiments for both Android and iOS on high end hardware from 2020."]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"TTI, or time to interactive, is the duration of time from the app being launched to the user being able to interact with it. For this benchmark, we define it as the time from pressing the app icon to the first screen being rendered. We also show screen recordings of starting up Mattermost."}),"\n",(0,i.jsx)(t.li,{children:"The binary size was measured as APK size on android and IPA size on iOS."}),"\n",(0,i.jsx)(t.li,{children:"The memory consumption data was collected by using the Mattermost app over the span of a couple minutes. The same actions were performed in the app on both engines."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"android-benchmarking-data",children:"Android Benchmarking Data"}),"\n",(0,i.jsx)(t.p,{children:"All the android tests were performed on a Samsung Galaxy S20."}),"\n",(0,i.jsx)("figure",{children:(0,i.jsx)("img",{src:"/blog/assets/hermes-default-android-data.png",alt:"Android Benchmarking Data"})}),"\n",(0,i.jsx)(t.h3,{id:"tti-video",children:"TTI Video"}),"\n",(0,i.jsx)("figure",{children:(0,i.jsx)("img",{src:"/blog/assets/hermes-default-android-video.gif",alt:"Android TTI Video"})}),"\n",(0,i.jsx)(t.h2,{id:"ios-benchmarking-data",children:"iOS Benchmarking Data"}),"\n",(0,i.jsx)(t.p,{children:"All the iOS tests were performed on an iPhone 12 Pro."}),"\n",(0,i.jsx)("figure",{children:(0,i.jsx)("img",{src:"/blog/assets/hermes-default-ios-data.png",alt:"iOS Benchmarking Data"})}),"\n",(0,i.jsx)(t.h3,{id:"tti-video-1",children:"TTI Video"}),"\n",(0,i.jsx)("figure",{children:(0,i.jsx)("img",{src:"/blog/assets/hermes-default-ios-video.gif",alt:"iOS TTI Video"})}),"\n",(0,i.jsx)(t.h3,{id:"slowed-down-tti-video-to-better-show-the-difference-in-startup-time",children:"Slowed Down TTI Video, to better show the difference in startup time."}),"\n",(0,i.jsx)("figure",{children:(0,i.jsx)("img",{src:"/blog/assets/hermes-default-ios-slow-video.gif",alt:"iOS Slowed Down TTI Video"})}),"\n",(0,i.jsx)(t.h2,{id:"react-nativehermes-integration",children:"React Native/Hermes Integration"}),"\n",(0,i.jsxs)(t.p,{children:["We addressed a long-standing problem that has caused compatibility issues and is a recurrent problem when releasing new React Native versions: React Native depended on Hermes via prebuilt binaries distributed through CocoaPods and npm, which makes it possible to have API or ",(0,i.jsx)(t.a,{href:"https://github.com/react-native-community/discussions-and-proposals/issues/257",children:"ABI incompatibilities"}),". To solve this problem, starting on React Native 0.69, Hermes is built alongside every version of React Native. This ensures full compatibility with each version React Native. This also creates a much tighter integration. It unlocks a more rapid iteration time to develop features or deploy bug fixes, and will give us greater confidence in making sure big changes to Hermes are done correctly. There is more in-depth information on the new integration change ",(0,i.jsx)(t.a,{href:"https://github.com/facebook/react-native-website/pull/3159/files",children:"here"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"ios-intl",children:"iOS Intl"}),"\n",(0,i.jsxs)(t.p,{children:["We finished the iOS counterpart implementation for ",(0,i.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl",children:(0,i.jsx)(t.code,{children:"Intl"})}),", the ECMAScript Internationalization API that provides a broad range of language sensitive functionality. This was a long-standing ",(0,i.jsx)(t.a,{href:"https://github.com/facebook/hermes/issues/23",children:"gap"})," that prevented some developers from using Hermes. The Android implementation, done in partnership with Microsoft, was shipped in React Native 0.65. With React Native 0.70, developers will have native support on both platforms."]}),"\n",(0,i.jsxs)(t.p,{children:["Typical implementations for ",(0,i.jsx)(t.code,{children:"Intl"})," require importing large lookup tables or data like ",(0,i.jsx)(t.a,{href:"https://cldr.unicode.org/index",children:"Unicode CLDR"}),". However, that can come with an expensive size increase of up to 6MB, so in order to avoid bloating the binary size of Hermes, we implemented ",(0,i.jsx)(t.code,{children:"Intl"})," by calling into APIs exposed by iOS itself. This means we can take advantage of all the locale and internationalization data that comes with iOS already."]}),"\n",(0,i.jsx)(t.h2,{id:"ongoing-work",children:"Ongoing Work"}),"\n",(0,i.jsx)(t.p,{children:"As we continue evolving Hermes, we want to give the community a sense of our immediate priorities: improving developer experience and ensuring nobody avoids using Hermes due to lack of JavaScript language features. More specifically, we're:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Enabling developers to run the sampling profiler directly from the Chrome devtools UI."}),"\n",(0,i.jsxs)(t.li,{children:["Adding support for ",(0,i.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt",children:(0,i.jsx)(t.code,{children:"BigInt"})}),", a long-standing request from the community that may block some developers from using Hermes as it can\u2019t be polyfilled."]}),"\n",(0,i.jsxs)(t.li,{children:["Adding support for ",(0,i.jsx)(t.a,{href:"https://github.com/facebook/hermes/issues/658",children:(0,i.jsx)(t.code,{children:"WeakRef"})}),", which will expose new memory management controls to developers."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"wrap-up",children:"Wrap Up"}),"\n",(0,i.jsxs)(t.p,{children:["Hermes becoming the default marks the beginning of a long-term journey. We are working on new features that will enable the community to write efficient apps for many years to come. We also encourage the community to reach out on our ",(0,i.jsx)(t.a,{href:"https://github.com/facebook/react-native",children:"GitHub Repo"})," to post any bugs, questions, feedback or ideas! We have created a ",(0,i.jsx)(t.code,{children:"hermes"})," label that can be used for any Hermes-specific posts."]})]})}const h=function(e={}){const{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?(0,i.jsx)(t,Object.assign({},e,{children:(0,i.jsx)(c,e)})):c(e)}},71426:(e,t,n)=>{var i=n(27378),a=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,n){var i,r={},d=null,c=null;for(i in void 0!==n&&(d=""+n),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:a,type:e,key:d,ref:c,props:r,_owner:s.current}}t.Fragment=r,t.jsx=d,t.jsxs=d},24246:(e,t,n)=>{e.exports=n(71426)},71670:(e,t,n)=>{n.d(t,{Zo:()=>s,ah:()=>r});var i=n(27378);const a=i.createContext({});function r(e){const t=i.useContext(a);return i.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const o={};function s({components:e,children:t,disableParentContext:n}){let s;return s=n?"function"==typeof e?e({}):e||o:r(e),i.createElement(a.Provider,{value:s},t)}}}]);